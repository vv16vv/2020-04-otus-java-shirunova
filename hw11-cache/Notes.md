# Домашнее задание HW11-cache

## Описание
Тест `StressCacheTest` содержит 2 тестовых метода 
- `readManyUsers` - работа с DBServiceUser без кэша
- `readManyCachedUsers` - работа с DBServiceUser c кэшом.

Каждый тест записывает 10000 записей в базу данных и затем их читает.  

## Результаты
Были проведены измерения длительности теста и вычисления изменения производительности при разных значениях размера heap памяти.
Для каждого значения памяти было проведено по 5 измерений, усредненные значения приведены в таблицах ниже.

Изменение производительности вычислялось по следующей формуле:
> (`Время работы без кэша` - `Время работы с кэшом`) / `Время работы без кэша` * 100%

### Параметры памяти `-Xmx50m -Xms50m`

| Тест | Общее время работы теста, с | Увеличение производительности, % | Время работы GC, c | Доля времени GC, % |
| --- | --- | --- | --- | --- |
| без кэша | 14.241 | - | 0.217 | 1.52 % |
| с кэшом | 11.378 | на 20.12 % | 0.189 | 1.67 % |

### Параметры памяти `-Xmx20m -Xms20m`

| Тест | Общее время работы теста, с | Увеличение производительности, % | Время работы GC, c | Доля времени GC, % |
| --- | --- | --- | --- | --- |
| без кэша | 18.648 | - | 0.730 | 3.92 % |
| с кэшом | 15.454 | 17.12 % | 0.778 | 5.03 % |

### Параметры памяти `-Xmx15m -Xms15m`

| Тест | Общее время работы теста, с | Увеличение производительности, % | Время работы GC, c | Доля времени GC, % |
| --- | --- | --- | --- | --- |
| без кэша | 20.564 | - | 2.154 | 10.48 % |
| с кэшом | 15.204 | на 26.05 % | 2.095 | 13.80 % |

### Параметры памяти `-Xmx10m -Xms10m`

| Тест | Общее время работы теста, с | Увеличение производительности, % | Время работы GC, c | Доля времени GC, % |
| --- | --- | --- | --- | --- |
| без кэша | 201.448 | - | 181.512  | 90.10 % |
| с кэшом | 199.846 | на 0.80 % | 183.179 | 91.66 % |

## Выводы

Использование кэша позволяет ускорить доступ к данным - в данном тесте в среднем на 20%.

Аномальные значения времени работы теста при размере heap 10М объясняются тем, что основная часть времени уходит на garbage collection - порядка 90%. Для кэшированных данных даже чуть больше.
Из-за нехватки памяти объекты в кэше не задерживаются и быстро освобождаются. А сам кэш вносит дополнительную нагрузку на память и поэтому некоторые запуски показали ухудшение времени с использованием кэша, чем без него.

Разброс значений увеличения производительности в остальных случаях объясняется скорее погрешностью измерений вследствие небольшого числа измерений, а также другими факторами - влияние IDE, в рамках которой совершались запуски, загрузка процессора другими приложения и т.п.
